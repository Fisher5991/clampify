/*!
 * Clampify v1.0.1
 *
 * Copyright (c) 2016 Artem Vozhzhov <vojjov.artem@ya.ru>
 *
 * Licenced under the MIT licence.
 */
!function(t){var i=0,s=0,h=[],n=100,e=function Clampify(t,s){s=s||{};var h=++i;this.t=function(){return h},this.i=t,this.i.clampify=this,this.s=t.innerHTML,this.h=document.createElement("span"),this.h.appendChild(document.createTextNode(" "));var n=s.endsWith||"…",e=s.endsWithClass||"clampify-end";this.o=s.o||/[.,?!\/\\:\-\s]+$/,this.setMaxLines(s.maxLines),this.u={overflowY:this.i.style.overflowY,maxHeight:this.i.style.maxHeight},this.p(),n instanceof Node?this.v=n.cloneNode(!0):(this.v=document.createElement("span"),this.v.className=e,this.v.appendChild(document.createTextNode(n))),this.m=document.createElement("span"),this.l=document.createElement("span"),this.l.appendChild(this.m),s.autoUpdate&&this.enableAutoUpdate()};if(e.setWindowResizeDelay=function(t){n=t<1?1:t},e.prototype.p=function(){if(this.g>0){this.i.innerHTML="",this.i.appendChild(this.h);var t=this.i.offsetHeight||this.i.clientHeight,i=this.h.offsetHeight;this.A=Math.max(t,i)*this.g,this.resetContent(),this.M()}else this.A=this.i.offsetHeight||this.i.clientHeight},e.prototype.N=function(){return this.l.offsetHeight>this.A},e.prototype.M=function(){this.i.style.overflowY="hidden",this.i.style.maxHeight=this.A+"px"},e.prototype.T=function(){this.i.style.overflowY=this.u.overflowY,this.i.style.maxHeight=this.u.maxHeight},e.prototype.$=function(){this.m.innerHTML=this.i.innerHTML,this.i.innerHTML="",this.i.appendChild(this.l)},e.prototype.k=function(){this.i.innerHTML=this.m.innerHTML},e.prototype.C=function(t){(t=t||this.l).appendChild(this.v)},e.prototype.I=function(t){(t=t||this.l).removeChild(this.v)},e.prototype.L=function(t){return t.join(" ").replace(this.o,"")},e.prototype.U=function(t){if((t=t||this.m)instanceof Text){var i=t.textContent.split(" ");for(t.textContent=this.L(i);this.N()&&i.length>0;)i.pop(),t.textContent=this.L(i);if(!t.textContent){var s;t.previousSibling?(s=t.previousSibling,t.parentNode.removeChild(t)):(s=t.parentNode.previousSibling,t.parentNode.parentNode.removeChild(t.parentNode)),this.U(s)}}else{var h=t.cloneNode(!0);for(t.innerHTML="";h.childNodes.length>0;){var n=h.childNodes[0];if(t.appendChild(n),this.N()){this.U(n);break}}}},e.prototype.setMaxLines=function(t){t=parseInt(t),this.g=isNaN(t)?0:t},e.prototype.getMaxLines=function(){return this.g},e.prototype.resetContent=function(){this.i.innerHTML=this.s},e.prototype.truncate=function(){this.resetContent(),this.p(),this.$(),this.N()&&(this.C(),this.U(),this.I(),this.C(this.m)),this.k()},e.prototype.getId=function(){return this.t()},e.prototype.enableAutoUpdate=function(){h.push(this)},e.prototype.disableAutoUpdate=function(){for(var t=0,i=h.length;t<i;t++)if(this.getId()===h[t].getId()){h.splice(t,1);break}},e.prototype.destroy=function(){this.disableAutoUpdate(),this.resetContent(),this.T(),delete this.i.clampify},t.addEventListener("resize",function(){clearTimeout(s),s=setTimeout(function(){for(var t=0,i=h.length;t<i;t++)h[t].truncate()},n)}),t.Clampify=e,t.$clampify=function $clampify(t,i){return new e(t,i).truncate(),t},void 0!==t.jQuery){var o=t.jQuery,f=["getId","resetContent","truncate","destroy","enableAutoUpdate","disableAutoUpdate","setMaxLines","getMaxLines"];o.fn.clampify=function(t){var i=Array.prototype.slice.apply(arguments);return i.shift(),o(this).each(function(){if("string"==typeof t){if(f.indexOf(t)>-1&&this.clampify instanceof e)return"function"==typeof this.clampify[t]&&this.clampify[t].apply(this.clampify,i),o(this);t={}}return this.clampify instanceof e&&this.clampify.destroy(),$clampify(this,t)})}}}(window);