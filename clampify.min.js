/*!
 * Clampify v1.0.1
 *
 * Copyright (c) 2016 Artem Vozhzhov <vojjov.artem@ya.ru>
 *
 * Licenced under the MIT licence.
 */
!function(t){var i=0,s=0,h=[],n=100,f=function Clampify(t,s){s=s||{};var h=++i;this.t=function(){return h},this.i=t,this.i.clampify=this,this.s=t.innerHTML,this.h=document.createElement("span"),this.h.appendChild(document.createTextNode(" "));var n=s.endsWith||"…",f=s.endsWithClass||"clampify-end",o=parseInt(s.maxLines);this.o=s.o||/[.,?!\/\\:\-\s]+$/,this.u=isNaN(o)?0:o,this.m={overflowY:this.i.style.overflowY,maxHeight:this.i.style.maxHeight},this.v(),n instanceof Node?this.p=n.cloneNode(!0):(this.p=document.createElement("span"),this.p.className=f,this.p.appendChild(document.createTextNode(n))),this.l=document.createElement("span"),this.N=document.createElement("span"),this.N.appendChild(this.l),s.autoUpdate&&this.enableAutoUpdate()};if(f.setWindowResizeDelay=function(t){n=t<1?1:t},f.prototype.v=function(){if(this.u>0){this.i.innerHTML="",this.i.appendChild(this.h);var t=this.i.offsetHeight||this.i.clientHeight,i=this.h.offsetHeight;this.T=Math.max(t,i)*this.u,this.resetContent(),this.$()}else this.T=this.i.offsetHeight||this.i.clientHeight},f.prototype.g=function(){return this.N.offsetHeight>this.T},f.prototype.$=function(){this.i.style.overflowY="hidden",this.i.style.maxHeight=this.T+"px"},f.prototype.k=function(){this.i.style.overflowY=this.m.overflowY,this.i.style.maxHeight=this.m.maxHeight},f.prototype.C=function(){this.l.innerHTML=this.i.innerHTML,this.i.innerHTML="",this.i.appendChild(this.N)},f.prototype.H=function(){this.i.innerHTML=this.l.innerHTML},f.prototype.I=function(t){(t=t||this.N).appendChild(this.p)},f.prototype.M=function(t){(t=t||this.N).removeChild(this.p)},f.prototype.Y=function(t){return t.join(" ").replace(this.o,"")},f.prototype._=function(t){if((t=t||this.l)instanceof Text){var i=t.textContent.split(" ");for(t.textContent=this.Y(i);this.g()&&i.length>0;)i.pop(),t.textContent=this.Y(i);if(!t.textContent){var s;t.previousSibling?(s=t.previousSibling,t.parentNode.removeChild(t)):(s=t.parentNode.previousSibling,t.parentNode.parentNode.removeChild(t.parentNode)),this._(s)}}else{var h=t.cloneNode(!0);for(t.innerHTML="";h.childNodes.length>0;){var n=h.childNodes[0];if(t.appendChild(n),this.g()){this._(n);break}}}},f.prototype.resetContent=function(){this.i.innerHTML=this.s},f.prototype.truncate=function(){this.resetContent(),this.v(),this.C(),this.g()&&(this.I(),this._(),this.M(),this.I(this.l)),this.H()},f.prototype.getId=function(){return this.t()},f.prototype.enableAutoUpdate=function(){h.push(this)},f.prototype.disableAutoUpdate=function(){for(var t=0,i=h.length;t<i;t++)if(this.getId()===h[t].getId()){h.splice(t,1);break}},f.prototype.destroy=function(){this.disableAutoUpdate(),this.resetContent(),this.k(),delete this.i.clampify},t.addEventListener("resize",function(){clearTimeout(s),s=setTimeout(function(){for(var t=0,i=h.length;t<i;t++)h[t].truncate()},n)}),t.Clampify=f,t.$clampify=function $clampify(t,i){return new f(t,i).truncate(),t},void 0!==t.jQuery){var o=t.jQuery;o.fn.clampify=function(t){return o(this).each(function(){if("string"==typeof t){if(-1===t.indexOf("_")&&this.clampify instanceof f)return"function"==typeof this.clampify[t]&&this.clampify[t].apply(this.clampify),o(this);t={}}return this.clampify instanceof f&&this.clampify.destroy(),$clampify(this,t)})}}}(window);