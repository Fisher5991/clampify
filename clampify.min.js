/*!
 * Clampify v1.0.0
 *
 * Copyright (c) 2016 Artem Vozhzhov <vojjov.artem@ya.ru>
 *
 * Licenced under the MIT licence.
 */!function(e){var t=0,i=0,n=[],r=100,o=function(e,i){i=i||{};var n=++t;this._getId=function(){return n},this.element=e,this.element.clampify=this,this.originalContent=e.innerHTML;var r=i.endsWith||"â€¦",o=i.endsWithClass||"clampify-end";this.removeEndChars=i.removeEndChars||/[.,?!\/\\:\-\s]+$/,this._updateLimit(),r instanceof Node?this.endsWithNode=r.cloneNode(!0):(this.endsWithNode=document.createElement("span"),this.endsWithNode.className=o,this.endsWithNode.appendChild(document.createTextNode(r))),this.innerWrapper=document.createElement("span"),this.outerWrapper=document.createElement("span"),this.outerWrapper.appendChild(this.innerWrapper),i.autoUpdate&&this.enableAutoUpdate()};if(o.setWindowResizeDelay=function(e){r=1>e?1:e},o.prototype._updateLimit=function(){this.limit=this.element.offsetHeight||this.element.clientHeight},o.prototype._isOverLimited=function(){return this.outerWrapper.offsetHeight>this.limit},o.prototype._wrap=function(){this.innerWrapper.innerHTML=this.element.innerHTML,this.element.innerHTML="",this.element.appendChild(this.outerWrapper)},o.prototype._unwrap=function(){this.element.innerHTML=this.innerWrapper.innerHTML},o.prototype._addEndsWithNode=function(e){e=e||this.outerWrapper,e.appendChild(this.endsWithNode)},o.prototype._removeEndsWithNode=function(e){e=e||this.outerWrapper,e.removeChild(this.endsWithNode)},o.prototype._joinWords=function(e){return e.join(" ").replace(this.removeEndChars,"")},o.prototype._calculate=function(e){if(e=e||this.innerWrapper,e instanceof Text){var t=e.textContent.split(" ");for(e.textContent=this._joinWords(t);this._isOverLimited()&&t.length>0;)t.pop(),e.textContent=this._joinWords(t);if(!e.textContent){var i;e.previousSibling?(i=e.previousSibling,e.parentNode.removeChild(e)):(i=e.parentNode.previousSibling,e.parentNode.parentNode.removeChild(e.parentNode)),this._calculate(i)}}else{var n=e.cloneNode(!0);for(e.innerHTML="";n.childNodes.length>0;){var r,o=n.childNodes[0];if(e.appendChild(o),r=this._isOverLimited()){this._calculate(o);break}}}},o.prototype.resetContent=function(){this.element.innerHTML=this.originalContent},o.prototype.truncate=function(){this.resetContent(),this._updateLimit(),this._wrap(),this._isOverLimited()&&(this._addEndsWithNode(),this._calculate(),this._removeEndsWithNode(),this._addEndsWithNode(this.innerWrapper)),this._unwrap()},o.prototype.getId=function(){return this._getId()},o.prototype.enableAutoUpdate=function(){n.push(this)},o.prototype.disableAutoUpdate=function(){for(var e=0,t=n.length;t>e;e++)if(this.getId()===n[e].getId()){n.splice(e,1);break}},o.prototype.destroy=function(){this.disableAutoUpdate(),this.resetContent(),delete this.element.clampify},e.addEventListener("resize",function(){clearTimeout(i),i=setTimeout(function(){for(var e=0,t=n.length;t>e;e++)n[e].truncate()},r)}),e.Clampify=o,e.$clampify=function(e,t){var i=new o(e,t);return i.truncate(),e},"undefined"!=typeof e.jQuery){var s=e.jQuery;s.fn.clampify=function(e){return s(this).each(function(){if("string"==typeof e){if(-1===e.indexOf("_")&&this.clampify instanceof o)return"function"==typeof this.clampify[e]&&this.clampify[e].apply(this.clampify),s(this);e={}}return this.clampify instanceof o&&this.clampify.destroy(),$clampify(this,e)})}}}(window);